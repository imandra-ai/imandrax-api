type color =
  | Red
  | Green
  | Blue

type simple_result =
  | Ok
  | Error of LString.t

type binary_op =
  | Add of int * int
  | Subtract of int * int
  | Multiply of int * int

type shape =
  | Circle of real
  | Rectangle of real * real
  | Triangle of real * real * real

type expr =
  | Const of int
  | Var of LString.t
  | Add of expr * expr
  | Mul of expr * expr

type http_method =
  | GET
  | POST of LString.t
  | PUT of LString.t * LString.t list
  | DELETE

type option_like =
  | Nothing
  | Something of int

let model_color (c: color) = true

let model_simple_result (r: simple_result) =
  match r with
  | Ok -> true
  | Error msg -> LString.length msg > 0

let model_binary_op (op: binary_op) = true

let model_shape (s: shape) =
  match s with
  | Circle r -> Real.(r > of_int 0)
  | Rectangle (w, h) -> Real.(w > of_int 0 && h > of_int 0)
  | Triangle (a, b, c) -> Real.(a > of_int 0 && b > of_int 0 && c > of_int 0)

let model_expr (e: expr) = true

let model_http_method (m: http_method) =
  match m with
  | GET -> true
  | POST body -> LString.length body > 0
  | PUT (body, headers) -> LString.length body > 0
  | DELETE -> true

let model_option_like (o: option_like) =
  match o with
  | Nothing -> false
  | Something x -> true
