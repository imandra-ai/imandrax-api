type point = {
  x: int;
  y: int;
}

type person = {
  name: LString.t;
  age: int;
  email: LString.t option;
}

type nested_record = {
  id: int;
  location: point;
  owner: person;
}

type record_with_collections = {
  tags: LString.t list;
  scores: real list;
  metadata: (LString.t * int) option;
}

type complex_fields = {
  simple: int;
  optional: real option;
  nested_list: int list list;
  tuple_field: LString.t * bool;
}

let model_point (p: point) = p.x >= 0 && p.y >= 0

let model_person (p: person) =
  LString.length p.name > 0 && p.age >= 0

let model_nested_record (r: nested_record) =
  r.id > 0 && r.location.x >= 0 && r.location.y >= 0 && LString.length r.owner.name > 0

let model_record_with_collections (r: record_with_collections) =
  List.length r.tags > 0 && List.length r.scores > 0

let model_complex_fields (c: complex_fields) =
  c.simple <> 0 && List.length c.nested_list > 0
