type event =
  | Click of { x: int; y: int }
  | Keypress of { key: LChar.t; modifiers: LString.t list }
  | Scroll of { delta: real }

type user_action =
  | Login of { username: LString.t; timestamp: int }
  | Logout
  | UpdateProfile of { fields: (LString.t * LString.t) list; timestamp: int }

type api_response =
  | Success of { data: LString.t; code: int }
  | Error of { message: LString.t; code: int; details: LString.t option }
  | Pending

type database_query =
  | Select of { table: LString.t; columns: LString.t list; where_clause: LString.t option }
  | Insert of { table: LString.t; values: (LString.t * LString.t) list }
  | Update of { table: LString.t; set_values: (LString.t * LString.t) list; where_clause: LString.t }
  | Delete of { table: LString.t; where_clause: LString.t }

let model_event (e: event) =
  match e with
  | Click {x; y} -> x >= 0 && y >= 0
  | Keypress {key; modifiers} -> true
  | Scroll {delta} -> true

let model_user_action (a: user_action) =
  match a with
  | Login {username; timestamp} -> LString.length username > 0 && timestamp > 0
  | Logout -> true
  | UpdateProfile {fields; timestamp} -> List.length fields > 0 && timestamp > 0

let model_api_response (r: api_response) =
  match r with
  | Success {data; code} -> LString.length data > 0 && code >= 200 && code < 300
  | Error {message; code; details} -> LString.length message > 0 && code >= 400
  | Pending -> true

let model_database_query (q: database_query) =
  match q with
  | Select {table; columns; where_clause} -> LString.length table > 0 && List.length columns > 0
  | Insert {table; values} -> LString.length table > 0 && List.length values > 0
  | Update {table; set_values; where_clause} -> LString.length table > 0 && List.length set_values > 0
  | Delete {table; where_clause} -> LString.length table > 0 && LString.length where_clause > 0
